# ğŸ” SOC Network Traffic Analysis Report â€“ Wireshark Lab

## 1. Overview

This report documents the analysis of network traffic captured from a Linux VM using Wireshark, focusing on TCP, UDP, ports, HTTP, DNS, and IP addresses. The objective is to interpret the traffic like a SOC analyst while explaining core networking concepts.ğŸ“Š

The traffic primarily consists of DNS lookups, HTTP requests to Firefox connectivity endpoints, and related TCP sessions, representing a normal browsing scenario rather than malicious activity.

---

## 2. Tools and Core Concepts

### 2.1 What is Wireshark? ğŸ¬

Wireshark is an openâ€‘source network protocol analyzer that captures packets from a network interface and displays them with details like source/destination IPs, ports, protocol fields, and payloads. It is widely used by network engineers and security analysts for troubleshooting, protocol analysis, and incident investigations.

In this lab, Wireshark is used to:

- Capture live traffic on `eth0`.
- Filter on DNS (`udp.port == 53`), HTTP (`http`), and TCP (`tcp.port == 80`).
- Inspect packet headers and payloads at different OSI layers.

### 2.2 What is TCP?

Transmission Control Protocol (TCP) is a reliable transportâ€‘layer protocol that ensures ordered, errorâ€‘checked delivery of data between two endpoints. It uses sequence numbers, acknowledgments, retransmissions, and flow control to guarantee that all bytes reach the destination correctly.

In the capture:

- TCP is used between `10.0.2.15` and `34.107.221.82` for HTTP communication over port 80.  
- The session shows the classic establishment, data transfer, and termination phases.

### 2.3 What is UDP?

User Datagram Protocol (UDP) is a connectionless transportâ€‘layer protocol that sends datagrams without establishing a session or guaranteeing delivery. It trades reliability for low overhead and latency, making it suitable for DNS, VoIP, and streaming.

In the capture:

- DNS traffic between `10.0.2.15` and `10.0.2.3` uses UDP port 53.  
- Each DNS query is a single UDP packet, and the answer is another packet; there is no handshake or retransmission logic at the UDP layer.

### 2.4 TCP Threeâ€‘Way Handshake (SYN, SYNâ€‘ACK, ACK) ğŸ¤

To create a reliable TCP connection, the client and server use a threeâ€‘step handshake:

1. SYN â€“ Client sends a segment with the SYN flag set to the server (e.g., from `10.0.2.15:54362` to `34.107.221.82:80`).  
2. SYNâ€‘ACK â€“ Server responds with SYN+ACK to acknowledge the request and propose its own sequence number.  
3. ACK â€“ Client sends a final ACK to confirm, and the connection becomes established.

This process ensures both sides agree on initial sequence numbers and confirms that the server port is open and reachable.[page:0][web:12] In the lab, the handshake is visible just before the HTTP GET request to `/success.txt` on port 80.ğŸ“¡

---

## 3. Ports, Open vs Closed

### 3.1 What is a Port?

A port is a 16â€‘bit logical identifier that allows multiple applications to share the same IP address but still receive the correct traffic. Wellâ€‘known ports 0â€“1023 map to common services such as HTTP (80), HTTPS (443), DNS (53), and SSH (22).

In the lab:

- Client ephemeral ports (e.g., 54362) are used as TCP/UDP source ports.  
- Destination ports include 53/UDP for DNS and 80/TCP for HTTP.

### 3.2 Open vs Closed Ports ğŸ§±

- Open port: There is a listening service bound to that port.  
  - For TCP, an open port responds to a SYN with SYNâ€‘ACK, allowing the handshake to complete.  
  - For UDP, an open port typically responds with a valid applicationâ€‘layer reply (e.g., DNS answer).

- Closed port: No listening service exists.  
  - For TCP, the host normally sends a RST (reset) packet in response to a SYN, or no response if filtered by a firewall.  
  - For UDP, closed or filtered ports often result in no response or an ICMP error.

From a SOC point of view, open ports define the exposed attack surface, while sudden changes in open ports or unexpected services on nonâ€‘standard ports can indicate compromise or misconfiguration.

---

## 4. Applicationâ€‘Layer Protocols: HTTP and DNS

### 4.1 What is HTTP? ğŸŒ

Hypertext Transfer Protocol (HTTP) is an applicationâ€‘layer protocol used by web browsers and servers to exchange resources like HTML, images, and JSON over TCP (commonly port 80 or 443 as HTTPS). It follows a requestâ€“response model: the client sends an HTTP request (method, path, headers), and the server returns a status code and payload.

In the capture:

- The browser sends `GET /success.txt?ipv4 HTTP/1.1` with headers like `Host: detectportal.firefox.com` and `User-Agent: Mozilla/...`. 
- The server at `34.107.221.82` replies with `HTTP/1.1 200 OK` and a small text body confirming connectivity.

These headers and status codes are extremely valuable for SOC investigations (e.g., identifying suspicious user agents, unusual URLs, or exfiltration via HTTP).ğŸ’»

### 4.2 What is DNS? ğŸ§¾

Domain Name System (DNS) is the â€œphonebook of the Internetâ€ that translates humanâ€‘readable domain names (like `detectportal.firefox.com`) into IP addresses so that clients can connect to servers. DNS uses a distributed hierarchy of servers (root, TLD, authoritative) to resolve names.

In the lab:

- `10.0.2.15` sends a DNS query from an ephemeral UDP source port to `10.0.2.3` on destination port 53.  
- The response includes A/AAAA records and CNAME chains pointing to Mozilla connectivity domains used by Firefox to test internet access.

From a SOC viewpoint:

- DNS is critical for detecting malware indicators, as many threats rely on domain names for commandâ€‘andâ€‘control and data exfiltration.

---

## 5. IP Addresses and Traffic Flows

### 5.1 What is an IP Address?

An IP address is a numerical label assigned to a device on a network so routers know where to forward packets.[web:33] IPv4 addresses look like `10.0.2.15`, while IPv6 addresses look like `fd00::1`; both uniquely identify endpoints within their scope.

In this lab:

- `10.0.2.15` â€“ Private IPv4 address of the VM.
- `10.0.2.3` â€“ Local DNS resolver.
- `34.107.221.82` â€“ Public web server used by Firefoxâ€™s connectivity check.

### 5.2 Endâ€‘toâ€‘End Flow ğŸŒ

Typical sequence when the browser accesses `http://detectportal.firefox.com/success.txt`:

1. Browser issues a DNS query for `detectportal.firefox.com` via UDP/53 to `10.0.2.3`.  
2. DNS server returns the IP address (e.g., `34.107.221.82`). 
3. Client initiates a TCP threeâ€‘way handshake with `34.107.221.82:80`.  
4. After the handshake, browser sends HTTP GET; server responds with HTTP 200 OK.

This illustrates how DNS, TCP, HTTP, ports, and IPs all combine to deliver a simple web pageâ€”a process SOC analysts must understand deeply when investigating alerts.

---

## 6. SOC Observations and Takeaways ğŸ›¡ï¸

- Traffic patterns and domains observed here match legitimate Firefox connectivity checks and OCSP/PKI infrastructure, with no obvious signs of malicious activity in this small dataset.
- The exercise demonstrates how to:
  - Trace a full TCP handshake.
  - Interpret DNS queries and responses.
  - Inspect HTTP headers and payloads for context.  
  These skills are foundational for intrusion detection, threat hunting, and incident response.

Future improvements could include examining HTTPS/TLS handshakes, testing with deliberate port scans, and correlating PCAP findings with SIEM logs to simulate a more realistic SOC workflow.ğŸš€
